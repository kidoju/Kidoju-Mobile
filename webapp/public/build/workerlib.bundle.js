!function(t,e){var n,r;"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("underscore",e):(t=t||self,n=t._,(r=t._=e()).noConflict=function(){return t._=n,r})}(this,function(){var t="1.12.0",e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},r=Array.prototype,s=Object.prototype,h="undefined"!=typeof Symbol?Symbol.prototype:null,i=r.push,o=r.slice,f=s.toString,n=s.hasOwnProperty,u="undefined"!=typeof ArrayBuffer,a="undefined"!=typeof DataView,c=Array.isArray,l=Object.keys,p=Object.create,y=u&&ArrayBuffer.isView,g=isNaN,d=isFinite,m=!{toString:null}.propertyIsEnumerable("toString"),v=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],E=Math.pow(2,53)-1;function x(i,u){return u=null==u?i.length-1:+u,function(){for(var t=Math.max(arguments.length-u,0),e=Array(t),n=0;n<t;n++)e[n]=arguments[n+u];switch(u){case 0:return i.call(this,e);case 1:return i.call(this,arguments[0],e);case 2:return i.call(this,arguments[0],arguments[1],e)}for(var r=Array(u+1),n=0;n<u;n++)r[n]=arguments[n];return r[u]=e,i.apply(this,r)}}function b(t){var e=typeof t;return"function"==e||"object"==e&&!!t}function w(t){return void 0===t}function _(t){return!0===t||!1===t||"[object Boolean]"===f.call(t)}function A(t){var e="[object "+t+"]";return function(t){return f.call(t)===e}}var F=A("String"),D=A("Number"),k=A("Date"),C=A("RegExp"),S=A("Error"),M=A("Symbol"),B=A("ArrayBuffer"),I=A("Function"),O=e.document&&e.document.childNodes,N=I="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof O?function(t){return"function"==typeof t||!1}:I,T=A("Object"),P=a&&T(new DataView(new ArrayBuffer(8))),q="undefined"!=typeof Map&&T(new Map),R=A("DataView");var j=P?function(t){return null!=t&&N(t.getInt8)&&B(t.buffer)}:R,G=c||A("Array");function L(t,e){return null!=t&&n.call(t,e)}var $=A("Arguments");!function(){$(arguments)||($=function(t){return L(t,"callee")})}();var V=$;function U(t){return D(t)&&g(t)}function z(t){return function(){return t}}function H(e){return function(t){t=e(t);return"number"==typeof t&&0<=t&&t<=E}}function K(e){return function(t){return null==t?void 0:t[e]}}var W=K("byteLength"),Z=H(W),J=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var X=u?function(t){return y?y(t)&&!j(t):Z(t)&&J.test(f.call(t))}:z(!1),Y=K("length");function Q(t,e){e=function(e){for(var n={},t=e.length,r=0;r<t;++r)n[e[r]]=!0;return{contains:function(t){return n[t]},push:function(t){return n[t]=!0,e.push(t)}}}(e);var n=v.length,r=t.constructor,i=N(r)&&r.prototype||s,u="constructor";for(L(t,u)&&!e.contains(u)&&e.push(u);n--;)(u=v[n])in t&&t[u]!==i[u]&&!e.contains(u)&&e.push(u)}function tt(t){if(!b(t))return[];if(l)return l(t);var e,n=[];for(e in t)L(t,e)&&n.push(e);return m&&Q(t,n),n}function et(t,e){var n=tt(e),r=n.length;if(null==t)return!r;for(var i=Object(t),u=0;u<r;u++){var s=n[u];if(e[s]!==i[s]||!(s in i))return!1}return!0}function nt(t){return t instanceof nt?t:this instanceof nt?void(this._wrapped=t):new nt(t)}function rt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,W(t))}nt.VERSION=t,nt.prototype.valueOf=nt.prototype.toJSON=nt.prototype.value=function(){return this._wrapped},nt.prototype.toString=function(){return String(this._wrapped)};var it="[object DataView]";function ut(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"==i||"object"==i||"object"==typeof e)&&function t(e,n,r,i){e instanceof nt&&(e=e._wrapped);n instanceof nt&&(n=n._wrapped);var u=f.call(e);if(u!==f.call(n))return!1;if(P&&"[object Object]"==u&&j(e)){if(!j(n))return!1;u=it}switch(u){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return h.valueOf.call(e)===h.valueOf.call(n);case"[object ArrayBuffer]":case it:return t(rt(e),rt(n),r,i)}var s="[object Array]"===u;if(!s&&X(e)){var a=W(e);if(a!==W(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;s=!0}if(!s){if("object"!=typeof e||"object"!=typeof n)return!1;var u=e.constructor,a=n.constructor;if(u!==a&&!(N(u)&&u instanceof u&&N(a)&&a instanceof a)&&"constructor"in e&&"constructor"in n)return!1}r=r||[];i=i||[];var o=r.length;for(;o--;)if(r[o]===e)return i[o]===n;r.push(e);i.push(n);if(s){if((o=e.length)!==n.length)return!1;for(;o--;)if(!ut(e[o],n[o],r,i))return!1}else{var c,l=tt(e);if(o=l.length,tt(n).length!==o)return!1;for(;o--;)if(c=l[o],!L(n,c)||!ut(e[c],n[c],r,i))return!1}r.pop();i.pop();return!0}(t,e,n,r)}function st(t){if(!b(t))return[];var e,n=[];for(e in t)n.push(e);return m&&Q(t,n),n}function at(r){var i=Y(r);return function(t){if(null==t)return!1;var e=st(t);if(Y(e))return!1;for(var n=0;n<i;n++)if(!N(t[r[n]]))return!1;return r!==ft||!N(t[ot])}}var ot="forEach",ct=["clear","delete"],lt=["get","has","set"],ht=ct.concat(ot,lt),ft=ct.concat(lt),pt=["add"].concat(ct,ot,"has"),yt=q?at(ht):A("Map"),gt=q?at(ft):A("WeakMap"),dt=q?at(pt):A("Set"),mt=A("WeakSet");function vt(t){for(var e=tt(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r}function Et(t){for(var e={},n=tt(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e}function xt(t){var e,n=[];for(e in t)N(t[e])&&n.push(e);return n.sort()}function bt(o,c){return function(t){var e=arguments.length;if(c&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var r=arguments[n],i=o(r),u=i.length,s=0;s<u;s++){var a=i[s];c&&void 0!==t[a]||(t[a]=r[a])}return t}}var wt=bt(st),_t=bt(tt),At=bt(st,!0);function Ft(t){if(!b(t))return{};if(p)return p(t);var e=function(){};e.prototype=t;t=new e;return e.prototype=null,t}function Dt(t){return b(t)?G(t)?t.slice():wt({},t):t}function kt(t){return G(t)?t:[t]}function Ct(t){return nt.toPath(t)}function St(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function Mt(t,e,n){e=St(t,Ct(e));return w(e)?n:e}function Bt(t){return t}function It(e){return e=_t({},e),function(t){return et(t,e)}}function Ot(e){return e=Ct(e),function(t){return St(t,e)}}function Nt(i,u,t){if(void 0===u)return i;switch(null==t?3:t){case 1:return function(t){return i.call(u,t)};case 3:return function(t,e,n){return i.call(u,t,e,n)};case 4:return function(t,e,n,r){return i.call(u,t,e,n,r)}}return function(){return i.apply(u,arguments)}}function Tt(t,e,n){return null==t?Bt:N(t)?Nt(t,e,n):(b(t)&&!G(t)?It:Ot)(t)}function Pt(t,e){return Tt(t,e,1/0)}function qt(t,e,n){return nt.iteratee!==Pt?nt.iteratee(t,e):Tt(t,e,n)}function Rt(){}function jt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}nt.toPath=kt,nt.iteratee=Pt;var Gt=Date.now||function(){return(new Date).getTime()};function Lt(e){function n(t){return e[t]}var t="(?:"+tt(e).join("|")+")",r=RegExp(t),i=RegExp(t,"g");return function(t){return r.test(t=null==t?"":""+t)?t.replace(i,n):t}}var $t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Vt=Lt($t),Ut=Lt(Et($t)),zt=nt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ht=/(.)^/,Kt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Wt=/\\|'|\r|\n|\u2028|\u2029/g;function Zt(t){return"\\"+Kt[t]}var Jt=0;function Xt(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);n=Ft(t.prototype),i=t.apply(n,i);return b(i)?i:n}var Yt=x(function(i,u){var s=Yt.placeholder,a=function(){for(var t=0,e=u.length,n=Array(e),r=0;r<e;r++)n[r]=u[r]===s?arguments[t++]:u[r];for(;t<arguments.length;)n.push(arguments[t++]);return Xt(i,a,this,this,n)};return a});Yt.placeholder=nt;var Qt=x(function(e,n,r){if(!N(e))throw new TypeError("Bind must be called on a function");var i=x(function(t){return Xt(e,i,n,this,r.concat(t))});return i}),te=H(Y);function ee(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var i=r.length,u=0,s=Y(t);u<s;u++){var a=t[u];if(te(a)&&(G(a)||V(a)))if(1<e)ee(a,e-1,n,r),i=r.length;else for(var o=0,c=a.length;o<c;)r[i++]=a[o++];else n||(r[i++]=a)}return r}var ne=x(function(t,e){var n=(e=ee(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Qt(t[r],t)}return t});var re=x(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),ie=Yt(re,nt,1);function ue(t){return function(){return!t.apply(this,arguments)}}function se(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}e=Yt(se,2);function ae(t,e,n){e=qt(e,n);for(var r,i=tt(t),u=0,s=i.length;u<s;u++)if(e(t[r=i[u]],r,t))return r}function oe(u){return function(t,e,n){e=qt(e,n);for(var r=Y(t),i=0<u?0:r-1;0<=i&&i<r;i+=u)if(e(t[i],i,t))return i;return-1}}var ce=oe(1),O=oe(-1);function le(t,e,n,r){for(var i=(n=qt(n,r,1))(e),u=0,s=Y(t);u<s;){var a=Math.floor((u+s)/2);n(t[a])<i?u=a+1:s=a}return u}function he(u,s,a){return function(t,e,n){var r=0,i=Y(t);if("number"==typeof n)0<u?r=0<=n?n:Math.max(n+i,r):i=0<=n?Math.min(n+1,i):n+i+1;else if(a&&n&&i)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=s(o.call(t,r,i),U))?n+r:-1;for(n=0<u?r:i-1;0<=n&&n<i;n+=u)if(t[n]===e)return n;return-1}}var fe=he(1,ce,le),I=he(-1,O);function pe(t,e,n){n=(te(t)?ce:ae)(t,e,n);if(void 0!==n&&-1!==n)return t[n]}function ye(t,e,n){if(e=Nt(e,n),te(t))for(i=0,u=t.length;i<u;i++)e(t[i],i,t);else for(var r=tt(t),i=0,u=r.length;i<u;i++)e(t[r[i]],r[i],t);return t}function ge(t,e,n){e=qt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,u=Array(i),s=0;s<i;s++){var a=r?r[s]:s;u[s]=e(t[a],a,t)}return u}function de(o){return function(t,e,n,r){var i=3<=arguments.length;return function(t,e,n,r){var i=!te(t)&&tt(t),u=(i||t).length,s=0<o?0:u-1;for(r||(n=t[i?i[s]:s],s+=o);0<=s&&s<u;s+=o){var a=i?i[s]:s;n=e(n,t[a],a,t)}return n}(t,Nt(e,r,4),n,i)}}a=de(1),T=de(-1);function me(t,r,e){var i=[];return r=qt(r,e),ye(t,function(t,e,n){r(t,e,n)&&i.push(t)}),i}function ve(t,e,n){e=qt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,u=0;u<i;u++){var s=r?r[u]:u;if(!e(t[s],s,t))return!1}return!0}function Ee(t,e,n){e=qt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,u=0;u<i;u++){var s=r?r[u]:u;if(e(t[s],s,t))return!0}return!1}function xe(t,e,n,r){return te(t)||(t=vt(t)),0<=fe(t,e,n="number"!=typeof n||r?0:n)}R=x(function(t,n,r){var i,u;return N(n)?u=n:(n=Ct(n),i=n.slice(0,-1),n=n[n.length-1]),ge(t,function(t){var e=u;if(!e){if(null==(t=i&&i.length?St(t,i):t))return;e=t[n]}return null==e?e:e.apply(t,r)})});function be(t,e){return ge(t,Ot(e))}function we(t,r,e){var n,i,u=-1/0,s=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var a=0,o=(t=te(t)?t:vt(t)).length;a<o;a++)null!=(n=t[a])&&u<n&&(u=n);else r=qt(r,e),ye(t,function(t,e,n){i=r(t,e,n),(s<i||i===-1/0&&u===-1/0)&&(u=t,s=i)});return u}function _e(t,e,n){if(null==e||n)return(t=!te(t)?vt(t):t)[jt(t.length-1)];var r=(te(t)?Dt:vt)(t),t=Y(r);e=Math.max(Math.min(e,t),0);for(var i=t-1,u=0;u<e;u++){var s=jt(u,i),a=r[u];r[u]=r[s],r[s]=a}return r.slice(0,e)}function Ae(u,e){return function(n,r,t){var i=e?[[],[]]:{};return r=qt(r,t),ye(n,function(t,e){e=r(t,e,n);u(i,t,e)}),i}}var c=Ae(function(t,e,n){L(t,n)?t[n].push(e):t[n]=[e]}),u=Ae(function(t,e,n){t[n]=e}),lt=Ae(function(t,e,n){L(t,n)?t[n]++:t[n]=1}),ct=Ae(function(t,e,n){t[n?0:1].push(e)},!0),Fe=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function De(t,e,n){return e in n}var ke=x(function(t,e){var n={},r=e[0];if(null==t)return n;N(r)?(1<e.length&&(r=Nt(r,e[1])),e=st(t)):(r=De,e=ee(e,!1,!1),t=Object(t));for(var i=0,u=e.length;i<u;i++){var s=e[i],a=t[s];r(a,s,t)&&(n[s]=a)}return n}),ht=x(function(t,n){var e,r=n[0];return N(r)?(r=ue(r),1<n.length&&(e=n[1])):(n=ge(ee(n,!1,!1),String),r=function(t,e){return!xe(n,e)}),ke(t,r,e)});function Ce(t,e,n){return o.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function Se(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Ce(t,t.length-e)}function Me(t,e,n){return o.call(t,null==e||n?1:e)}var Be=x(function(t,e){return e=ee(e,!0,!0),me(t,function(t){return!xe(e,t)})}),q=x(function(t,e){return Be(t,e)});function Ie(t,e,n,r){_(e)||(r=n,n=e,e=!1),null!=n&&(n=qt(n,r));for(var i=[],u=[],s=0,a=Y(t);s<a;s++){var o=t[s],c=n?n(o,s,t):o;e&&!n?(s&&u===c||i.push(o),u=c):n?xe(u,c)||(u.push(c),i.push(o)):xe(i,o)||i.push(o)}return i}pt=x(function(t){return Ie(ee(t,!0,!0))});function Oe(t){for(var e=t&&we(t,Y).length||0,n=Array(e),r=0;r<e;r++)n[r]=be(t,r);return n}$t=x(Oe);function Ne(t,e){return t._chain?nt(e).chain():e}function Te(n){return ye(xt(n),function(t){var e=nt[t]=n[t];nt.prototype[t]=function(){var t=[this._wrapped];return i.apply(t,arguments),Ne(this,e.apply(nt,t))}}),nt}ye(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=r[e];nt.prototype[e]=function(){var t=this._wrapped;return null!=t&&(n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0]),Ne(this,t)}}),ye(["concat","join","slice"],function(t){var e=r[t];nt.prototype[t]=function(){var t=this._wrapped;return Ne(this,t=null!=t?e.apply(t,arguments):t)}});$t=Te({__proto__:null,VERSION:t,restArguments:x,isObject:b,isNull:function(t){return null===t},isUndefined:w,isBoolean:_,isElement:function(t){return!(!t||1!==t.nodeType)},isString:F,isNumber:D,isDate:k,isRegExp:C,isError:S,isSymbol:M,isArrayBuffer:B,isDataView:j,isArray:G,isFunction:N,isArguments:V,isFinite:function(t){return!M(t)&&d(t)&&!isNaN(parseFloat(t))},isNaN:U,isTypedArray:X,isEmpty:function(t){if(null==t)return!0;var e=Y(t);return"number"==typeof e&&(G(t)||F(t)||V(t))?0===e:0===Y(tt(t))},isMatch:et,isEqual:function(t,e){return ut(t,e)},isMap:yt,isWeakMap:gt,isSet:dt,isWeakSet:mt,keys:tt,allKeys:st,values:vt,pairs:function(t){for(var e=tt(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},invert:Et,functions:xt,methods:xt,extend:wt,extendOwn:_t,assign:_t,defaults:At,create:function(t,e){return t=Ft(t),e&&_t(t,e),t},clone:Dt,tap:function(t,e){return e(t),t},get:Mt,has:function(t,e){for(var n=(e=Ct(e)).length,r=0;r<n;r++){var i=e[r];if(!L(t,i))return!1;t=t[i]}return!!n},mapObject:function(t,e,n){e=qt(e,n);for(var r=tt(t),i=r.length,u={},s=0;s<i;s++){var a=r[s];u[a]=e(t[a],a,t)}return u},identity:Bt,constant:z,noop:Rt,toPath:kt,property:Ot,propertyOf:function(e){return null==e?Rt:function(t){return Mt(e,t)}},matcher:It,matches:It,times:function(t,e,n){var r=Array(Math.max(0,t));e=Nt(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},random:jt,now:Gt,escape:Vt,unescape:Ut,templateSettings:zt,template:function(u,t,e){t=At({},t=!t&&e?e:t,nt.templateSettings);var n,e=RegExp([(t.escape||Ht).source,(t.interpolate||Ht).source,(t.evaluate||Ht).source].join("|")+"|$","g"),s=0,a="__p+='";u.replace(e,function(t,e,n,r,i){return a+=u.slice(s,i).replace(Wt,Zt),s=i+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),t}),a+="';\n",a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(a=!t.variable?"with(obj||{}){\n"+a+"}\n":a)+"return __p;\n";try{n=new Function(t.variable||"obj","_",a)}catch(t){throw t.source=a,t}return e=function(t){return n.call(this,t,nt)},t=t.variable||"obj",e.source="function("+t+"){\n"+a+"}",e},result:function(t,e,n){var r=(e=Ct(e)).length;if(!r)return N(n)?n.call(t):n;for(var i=0;i<r;i++){var u=null==t?void 0:t[e[i]];void 0===u&&(u=n,i=r),t=N(u)?u.call(t):u}return t},uniqueId:function(t){var e=++Jt+"";return t?t+e:e},chain:function(t){return(t=nt(t))._chain=!0,t},iteratee:Pt,partial:Yt,bind:Qt,bindAll:ne,memoize:function(r,i){var u=function(t){var e=u.cache,n=""+(i?i.apply(this,arguments):t);return L(e,n)||(e[n]=r.apply(this,arguments)),e[n]};return u.cache={},u},delay:re,defer:ie,throttle:function(n,r,i){var u,s,a,o,c=0;function l(){c=!1===i.leading?0:Gt(),u=null,o=n.apply(s,a),u||(s=a=null)}function t(){var t=Gt();c||!1!==i.leading||(c=t);var e=r-(t-c);return s=this,a=arguments,e<=0||r<e?(u&&(clearTimeout(u),u=null),c=t,o=n.apply(s,a),u||(s=a=null)):u||!1===i.trailing||(u=setTimeout(l,e)),o}return i=i||{},t.cancel=function(){clearTimeout(u),c=0,u=s=a=null},t},debounce:function(n,r,i){function u(t,e){s=null,e&&(a=n.apply(t,e))}var s,a,t=x(function(t){var e;return s&&clearTimeout(s),i?(e=!s,s=setTimeout(u,r),e&&(a=n.apply(this,t))):s=re(u,r,this,t),a});return t.cancel=function(){clearTimeout(s),s=null},t},wrap:function(t,e){return Yt(e,t)},negate:ue,compose:function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:se,once:e,findKey:ae,findIndex:ce,findLastIndex:O,sortedIndex:le,indexOf:fe,lastIndexOf:I,find:pe,detect:pe,findWhere:function(t,e){return pe(t,It(e))},each:ye,forEach:ye,map:ge,collect:ge,reduce:a,foldl:a,inject:a,reduceRight:T,foldr:T,filter:me,select:me,reject:function(t,e,n){return me(t,ue(qt(e)),n)},every:ve,all:ve,some:Ee,any:Ee,contains:xe,includes:xe,include:xe,invoke:R,pluck:be,where:function(t,e){return me(t,It(e))},max:we,min:function(t,r,e){var n,i,u=1/0,s=1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var a=0,o=(t=te(t)?t:vt(t)).length;a<o;a++)null!=(n=t[a])&&n<u&&(u=n);else r=qt(r,e),ye(t,function(t,e,n){((i=r(t,e,n))<s||i===1/0&&u===1/0)&&(u=t,s=i)});return u},shuffle:function(t){return _e(t,1/0)},sample:_e,sortBy:function(t,r,e){var i=0;return r=qt(r,e),be(ge(t,function(t,e,n){return{value:t,index:i++,criteria:r(t,e,n)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")},groupBy:c,indexBy:u,countBy:lt,partition:ct,toArray:function(t){return t?G(t)?o.call(t):F(t)?t.match(Fe):te(t)?ge(t,Bt):vt(t):[]},size:function(t){return null==t?0:(te(t)?t:tt(t)).length},pick:ke,omit:ht,first:Se,head:Se,take:Se,initial:Ce,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:Me(t,Math.max(0,t.length-e))},rest:Me,tail:Me,drop:Me,compact:function(t){return me(t,Boolean)},flatten:function(t,e){return ee(t,e,!1)},without:q,uniq:Ie,unique:Ie,union:pt,intersection:function(t){for(var e=[],n=arguments.length,r=0,i=Y(t);r<i;r++){var u=t[r];if(!xe(e,u)){for(var s=1;s<n&&xe(arguments[s],u);s++);s===n&&e.push(u)}}return e},difference:Be,unzip:Oe,transpose:Oe,zip:$t,object:function(t,e){for(var n={},r=0,i=Y(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n=n||(e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),u=0;u<r;u++,t+=n)i[u]=t;return i},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(o.call(t,r,r+=e));return n},mixin:Te,default:nt});return $t._=$t});var _,window=new Function("return this")(),KAS={};"object"==typeof module&&module.exports?(_=require("underscore"),module.exports=KAS):(_=window._,window.KAS=KAS),function(t){var e,n,r,i,u,s,a,o,c,l,h,f,p,y,g,d,m,v,E,x,b,w,_,A,F,F=(x=[5,6,8,10,33,35,41,43,45],b=[1,39],w=[1,40],_=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],A=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],F=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],(F={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(t,e,n,r,i,u,s){var a=u.length-1;switch(i){case 1:return new r.Eq(u[a-3],u[a-2],u[a-1]);case 2:return u[a-1];case 3:return new r.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=u[a];break;case 5:this.$=r.Add.createOrAppend(u[a-2],u[a]);break;case 6:this.$=r.Add.createOrAppend(u[a-2],r.Mul.handleNegative(u[a],"subtract"));break;case 8:this.$=r.Mul.fold(r.Mul.createOrAppend(u[a-1],u[a]));break;case 9:this.$=r.Mul.fold(r.Mul.createOrAppend(u[a-2],u[a]));break;case 10:this.$=r.Mul.fold(r.Mul.handleDivide(u[a-2],u[a]));break;case 12:this.$=r.Mul.handleNegative(u[a]);break;case 14:case 17:this.$=[t];break;case 16:this.$=u[a-2].concat(u[a]);break;case 18:this.$=r.Log.natural();break;case 19:this.$=r.Log.common();break;case 21:this.$=r.Trig.create(u[a-1],u[a]);break;case 22:this.$=r.Log.create(u[a-1],u[a]);break;case 24:this.$=new r.Pow(u[a-2],u[a]);break;case 26:case 34:this.$=t;break;case 27:this.$=new r.Var(u[a-2],u[a]);break;case 28:this.$=new r.Var(u[a]);break;case 29:this.$=new r.Const(t.toLowerCase());break;case 30:this.$=r.Int.create(Number(t));break;case 31:this.$=r.Float.create(Number(t));break;case 32:this.$=u[a-1].completeParse();break;case 33:this.$=u[a-1].completeParse().addHint("parens");break;case 35:case 36:this.$=r.Pow.sqrt(u[a-1]);break;case 37:this.$=new r.Pow.nthroot(u[a-1],u[a-4]);break;case 38:case 39:case 40:this.$=new r.Abs(u[a-1]);break;case 41:this.$=new r.Func(u[a-3],u[a-1]);break;case 44:this.$=r.Mul.handleDivide(u[a-4],u[a-1])}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:e=[1,7],11:8,13:6,15:12,16:n=[1,17],17:9,19:r=[1,13],20:10,21:i=[1,14],22:u=[1,15],24:18,25:11,26:16,27:21,28:s=[1,32],29:a=[1,22],30:o=[1,23],31:c=[1,24],32:l=[1,25],34:h=[1,26],36:31,37:f=[1,33],38:19,39:p=[1,27],42:y=[1,28],43:g=[1,29],44:d=[1,30],46:m=[1,20]},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},D([5,6],[2,4],{8:v=[1,36],10:E=[1,37]}),D(x,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:b,14:w,16:n,19:r,21:i,22:u,28:s,29:a,30:o,31:c,32:l,34:h,37:f,39:p,42:y,44:d,46:m}),D(_,[2,11]),{10:e,11:8,13:41,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},D(_,[2,13]),{10:e,11:8,13:42,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{10:e,11:8,13:43,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},D(_,[2,23]),D(A,[2,15],{18:[1,44]}),D(A,[2,17]),D(A,[2,18]),D(A,[2,19],{23:[1,45]}),D(_,[2,25],{18:[1,46]}),D([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),D(F,[2,42]),D(F,[2,43]),{32:[1,47]},D(F,[2,28],{23:[1,48]}),D(F,[2,29]),D(F,[2,30]),D(F,[2,31]),{7:49,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:50,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:56,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{34:[1,57]},D([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{1:[2,2]},{9:59,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{9:60,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},D(_,[2,8]),{10:e,11:8,13:61,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{10:e,11:8,13:62,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},D(_,[2,12]),D(_,[2,21]),D(_,[2,22]),{10:e,11:8,13:63,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{24:64,27:21,28:s,29:a,30:o,31:c,32:l,34:h},{10:e,11:8,13:65,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:66,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{24:67,27:21,28:s,29:a,30:o,31:c,32:l,34:h},{8:v,10:E,33:[1,68]},{8:v,10:E,35:[1,69]},{7:70,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:71,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:72,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:73,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{8:v,10:E,43:[1,74]},{8:v,10:E,45:[1,75]},{7:76,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{6:[1,77]},D(x,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:b,14:w,16:n,19:r,21:i,22:u,28:s,29:a,30:o,31:c,32:l,34:h,37:f,39:p,42:y,44:d,46:m}),D(x,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:b,14:w,16:n,19:r,21:i,22:u,28:s,29:a,30:o,31:c,32:l,34:h,37:f,39:p,42:y,44:d,46:m}),D(_,[2,9]),D(_,[2,10]),D(A,[2,16]),D(A,[2,20]),D(_,[2,24]),{8:v,10:E,33:[1,78]},D(F,[2,27]),D(F,[2,32]),D(F,[2,33]),{8:v,10:E,35:[1,79]},{8:v,10:E,33:[1,80]},{8:v,10:E,41:[1,81]},{8:v,10:E,35:[1,82]},D(F,[2,39]),D(F,[2,40]),{8:v,10:E,35:[1,83]},{1:[2,1]},{32:[1,84]},D(F,[2,35]),D(F,[2,36]),{32:[1,85]},D(F,[2,38]),D(F,[2,41]),{7:86,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{7:87,9:5,10:e,11:8,13:6,15:12,16:n,17:9,19:r,20:10,21:i,22:u,24:18,25:11,26:16,27:21,28:s,29:a,30:o,31:c,32:l,34:h,36:31,37:f,38:19,39:p,42:y,43:g,44:d,46:m},{8:v,10:E,33:[1,88]},{8:v,10:E,33:[1,89]},D(F,[2,44]),D(F,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e,n=this,r=[0],i=[null],u=[],s=this.table,a="",o=0,c=0,l=0,h=1,f=u.slice.call(arguments,1),p=Object.create(this.lexer),y={yy:{}};for(e in this.yy)Object.prototype.hasOwnProperty.call(this.yy,e)&&(y.yy[e]=this.yy[e]);p.setInput(t,y.yy),y.yy.lexer=p,y.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var g=p.yylloc;u.push(g);var d=p.options&&p.options.ranges;"function"==typeof y.yy.parseError?this.parseError=y.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,v,E,x,b,w,_,A,F={};;){if(E=r[r.length-1],void 0===(x=this.defaultActions[E]||(null==m&&(A=void 0,m=A="number"!=typeof(A=p.lex()||h)&&n.symbols_[A]||A),s[E]&&s[E][m]))||!x.length||!x[0]){var D="",k=[];for(w in s[E])this.terminals_[w]&&2<w&&k.push("'"+this.terminals_[w]+"'");D=p.showPosition?"Parse error on line "+(o+1)+":\n"+p.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(o+1)+": Unexpected "+(m==h?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(D,{text:p.match,token:this.terminals_[m]||m,line:p.yylineno,loc:g,expected:k})}if(x[0]instanceof Array&&1<x.length)throw new Error("Parse Error: multiple actions possible at state: "+E+", token: "+m);switch(x[0]){case 1:r.push(m),i.push(p.yytext),u.push(p.yylloc),r.push(x[1]),m=null,v?(m=v,v=null):(c=p.yyleng,a=p.yytext,o=p.yylineno,g=p.yylloc,0<l&&l--);break;case 2:if(_=this.productions_[x[1]][1],F.$=i[i.length-_],F._$={first_line:u[u.length-(_||1)].first_line,last_line:u[u.length-1].last_line,first_column:u[u.length-(_||1)].first_column,last_column:u[u.length-1].last_column},d&&(F._$.range=[u[u.length-(_||1)].range[0],u[u.length-1].range[1]]),void 0!==(b=this.performAction.apply(F,[a,c,o,y.yy,x[1],i,u].concat(f))))return b;_&&(r=r.slice(0,-1*_*2),i=i.slice(0,-1*_),u=u.slice(0,-1*_)),r.push(this.productions_[x[1]][0]),i.push(F.$),u.push(F._$),_=s[r[r.length-2]][r[r.length-1]],r.push(_);break;case 3:return!0}}return!0}}).lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);t=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[t[0],t[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e)return e;if(this._backtrack){for(var i in r)this[i]=r[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),u=0;u<i.length;u++)if((n=this._input.match(this.rules[i[u]]))&&(!e||n[0].length>e[0].length))if(e=n,r=u,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[u])))return t;if(!this._backtrack)return!1;e=!1}else if(!this.options.flex)break;return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(t,e,n,r){switch(n){case 0:case 1:case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:return"^";case 6:case 7:case 8:case 9:return"*";case 10:case 11:return"/";case 12:case 13:return"-";case 14:return"+";case 15:return"^";case 16:return"(";case 17:return")";case 18:return"(";case 19:return")";case 20:return"[";case 21:return"]";case 22:return"{";case 23:return"}";case 24:return"{";case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:return e.yytext="<=","SIGN";case 33:return e.yytext=">=","SIGN";case 34:return e.yytext="<=","SIGN";case 35:return e.yytext=">=","SIGN";case 36:case 37:case 38:case 39:return e.yytext="<>","SIGN";case 40:return e.yytext="<=","SIGN";case 41:return e.yytext=">=","SIGN";case 42:case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:case 49:case 50:case 51:return"TRIG";case 52:return e.yytext="sin","TRIG";case 53:return e.yytext="cos","TRIG";case 54:return e.yytext="tan","TRIG";case 55:return e.yytext="csc","TRIG";case 56:return e.yytext="sec","TRIG";case 57:return e.yytext="cot","TRIG";case 58:return e.yytext="arcsin","TRIG";case 59:return e.yytext="arccos","TRIG";case 60:return e.yytext="arctan","TRIG";case 61:return e.yytext="arccsc","TRIG";case 62:return e.yytext="arcsec","TRIG";case 63:return e.yytext="arccot","TRIG";case 64:case 65:return"TRIGINV";case 66:return e.yytext="sinh","TRIG";case 67:return e.yytext="cosh","TRIG";case 68:return e.yytext="tanh","TRIG";case 69:return e.yytext="csch","TRIG";case 70:return e.yytext="sech","TRIG";case 71:return e.yytext="tanh","TRIG";case 72:return"CONST";case 73:case 74:return e.yytext="pi","CONST";case 75:return"VAR";case 76:case 77:return e.yytext="theta","VAR";case 78:return"VAR";case 79:case 80:return e.yytext="phi","VAR";case 81:return t.symbolLexer(e.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(e.yytext)}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|·)/,/^(?:\\times|×)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|÷)/,/^(?:-)/,/^(?:−)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:≠)/,/^(?:≤)/,/^(?:≥)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:π)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:θ)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:φ)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}},new((k.prototype=F).Parser=k));function D(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n}function k(){this.yy={}}t.parser=F}(KAS),function(t){var e,n,r,i,u,u=(i=[6,11],u=[6,11,13,17],(u={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(t,e,n,r,i,u,s){var a=u.length-1;switch(i){case 1:return{type:"unitMagnitude",magnitude:u[a-2],unit:u[a-1]};case 2:return{type:"unitStandalone",unit:u[a-1]};case 3:this.$=u[a-2]+"e"+u[a];break;case 4:case 13:case 14:case 15:case 17:this.$=u[a];break;case 5:this.$={num:u[a-2],denom:u[a]};break;case 6:this.$={num:u[a],denom:null};break;case 7:this.$=[u[a-2]].concat(u[a]);break;case 8:this.$=[u[a-1]].concat(u[a]);break;case 9:this.$=[u[a]];break;case 10:this.$={name:u[a-2],pow:u[a]};break;case 11:this.$={name:u[a],pow:1};break;case 12:this.$=t;break;case 16:this.$="-"+u[a]}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:e=[1,11],18:[1,6],19:n=[1,9]},{1:[3]},{5:12,10:5,12:8,14:10,17:e},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},s(r=[8,17],[2,13]),s(r,[2,14]),s(i,[2,9],{12:8,14:10,10:17,13:[1,16],17:e}),s([6,8,11,13,17],[2,15]),s(u,[2,11],{15:[1,18]}),s([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:e},{10:24,12:8,14:10,17:e},s(i,[2,8]),{16:25,19:n},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},s(i,[2,7]),s(u,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e,n=this,r=[0],i=[null],u=[],s=this.table,a="",o=0,c=0,l=0,h=1,f=u.slice.call(arguments,1),p=Object.create(this.lexer),y={yy:{}};for(e in this.yy)Object.prototype.hasOwnProperty.call(this.yy,e)&&(y.yy[e]=this.yy[e]);p.setInput(t,y.yy),y.yy.lexer=p,y.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var g=p.yylloc;u.push(g);var d=p.options&&p.options.ranges;"function"==typeof y.yy.parseError?this.parseError=y.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,v,E,x,b,w,_,A,F={};;){if(E=r[r.length-1],void 0===(x=this.defaultActions[E]||(null==m&&(A=void 0,m=A="number"!=typeof(A=p.lex()||h)&&n.symbols_[A]||A),s[E]&&s[E][m]))||!x.length||!x[0]){var D="",k=[];for(w in s[E])this.terminals_[w]&&2<w&&k.push("'"+this.terminals_[w]+"'");D=p.showPosition?"Parse error on line "+(o+1)+":\n"+p.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(o+1)+": Unexpected "+(m==h?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(D,{text:p.match,token:this.terminals_[m]||m,line:p.yylineno,loc:g,expected:k})}if(x[0]instanceof Array&&1<x.length)throw new Error("Parse Error: multiple actions possible at state: "+E+", token: "+m);switch(x[0]){case 1:r.push(m),i.push(p.yytext),u.push(p.yylloc),r.push(x[1]),m=null,v?(m=v,v=null):(c=p.yyleng,a=p.yytext,o=p.yylineno,g=p.yylloc,0<l&&l--);break;case 2:if(_=this.productions_[x[1]][1],F.$=i[i.length-_],F._$={first_line:u[u.length-(_||1)].first_line,last_line:u[u.length-1].last_line,first_column:u[u.length-(_||1)].first_column,last_column:u[u.length-1].last_column},d&&(F._$.range=[u[u.length-(_||1)].range[0],u[u.length-1].range[1]]),void 0!==(b=this.performAction.apply(F,[a,c,o,y.yy,x[1],i,u].concat(f))))return b;_&&(r=r.slice(0,-1*_*2),i=i.slice(0,-1*_),u=u.slice(0,-1*_)),r.push(this.productions_[x[1]][0]),i.push(F.$),u.push(F._$),_=s[r[r.length-2]][r[r.length-1]],r.push(_);break;case 3:return!0}}return!0}}).lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);t=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[t[0],t[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e)return e;if(this._backtrack){for(var i in r)this[i]=r[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),u=0;u<i.length;u++)if((n=this._input.match(this.rules[i[u]]))&&(!e||n[0].length>e[0].length))if(e=n,r=u,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[u])))return t;if(!this._backtrack)return!1;e=!1}else if(!this.options.flex)break;return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:case 10:case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}},new((a.prototype=u).Parser=a));function s(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n}function a(){this.yy={}}t.unitParser=u}(KAS),function(u){function e(t){throw new Error(t)}function f(t){return t!=t}var t=function(){throw new Error("Abstract method - must override for expr: "+this.print())};function r(){}function n(){}function l(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function h(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function p(t,e){this.base=t,this.exp=e}function a(t,e){this.base=t,this.power=e}function o(t,e){this.type=t,this.arg=e}function i(t){this.arg=t}function y(t,e,n){this.left=t,this.type=e,this.right=n}function s(){}function g(t,e){this.symbol=t,this.arg=e}function c(t,e){this.symbol=t,this.subscript=e}function d(t){this.symbol=t}function m(){}function v(t,e){e<0&&(t=-t,e=-e),this.n=t,this.d=e}function E(t){this.n=t}function x(t){this.n=t}_.extend(r.prototype,{func:t,args:t,construct:function(t){var e=new this.func;return this.func.apply(e,t),e},recurse:function(e){var n=Array.prototype.slice.call(arguments,1),t=_.map(this.args(),function(t){return _.isString(t)?t:t[e].apply(t,n)});return this.construct(t)},eval:t,codegen:t,compile:function(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch(t){throw new Error("Function did not compile: "+e)}},print:t,tex:t,asTex:function(t){_.defaults(t=t||{},{display:!0,dynamic:!0,times:!1});var e=this.tex();return t.display&&(e="\\displaystyle "+e),t.dynamic&&(e=(e=e.replace(/\(/g,"\\left(")).replace(/\)/g,"\\right)")),e=t.times?e.replace(/\\cdot/g,"\\times"):e},name:function(){return this.func.name||this.func.toString().match(/^function\s*([^\s(]+)/)[1]},repr:function(){return this.name()+"("+_.map(this.args(),function(t){return _.isString(t)?t:t.repr()}).join(",")+")"},strip:function(){return this.recurse("strip")},normalize:function(){return this.recurse("normalize")},expand:function(){return this.recurse("expand")},factor:function(t){return this.recurse("factor",t)},collect:function(t){return this.recurse("collect",t)},equals:function(t){return this.normalize().print()===t.normalize().print()},simplify:function(t){t=_.extend({once:!1},t);var e=this.factor(t),n=e.collect(t),r=(n=e.equals(n)?this.collect(t):n).expand(t),e=r.collect(t),e=e=r.equals(e)?n.collect(t):e;return t.once||this.equals(e)?e:e.simplify(t)},isSimplified:function(){return this.equals(this.simplify())},exprArgs:function(){return _.filter(this.args(),function(t){return t instanceof r})},getVars:function(t){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getVars",t))).sort()},getConsts:function(){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getConsts"))).sort()},getUnits:function(){return _.flatten(_.invoke(this.exprArgs(),"getUnits"))},is:function(t){return this instanceof t},has:function(e){return this instanceof e||_.any(this.exprArgs(),function(t){return t.has(e)})},raiseToThe:function(t){return new p(this,t)},isSubtract:function(){return!1},isDivide:function(){return!1},isRoot:function(){return!1},needsExplicitMul:function(){return this.args()[0].needsExplicitMul()},sameVars:function(t){function e(t,e){return!_.difference(t,e).length}var n=this.getVars(),r=t.getVars(),t=function(t){return _.uniq(_.invoke(t,"toLowerCase")).sort()};return{equal:e(n,r),equalIgnoringCase:e(t(n),t(r))}},compare:function(t){if(t instanceof y)return!1;function e(t,e){var n,r=(n=t,r=e,Math.abs(n)<1||Math.abs(r)<1?Math.abs(n-r):Math.abs(1-n/r));return t===e||f(t)&&f(e)||r<Math.pow(10,-9)}var n=_.union(this.getVars(!0),t.getVars(!0));if(!n.length&&!this.has(w)&&!t.has(w))return e(this.eval(),t.eval());var r=this.collect(),i=t.collect(),u=this.getUnits(),t=t.getUnits();if(!_.isEqual(u,t))return!1;for(var s=0;s<12;s++){var a,o,c={},l=Math.pow(10,1+Math.floor(3*s/12)),h=s%2==0;if(_.each(n,function(t){c[t]=h?function(t,e){e-=t;return Math.random()*e+t}(-l,l):_.random(-l,l)}),!(r.has(g)||i.has(g)||r.has(w)||i.has(w)?(a=r.partialEval(c),o=i.partialEval(c),a.simplify().equals(o.simplify())):e(a=r.eval(c),o=i.eval(c))))return!1}return!0},partialEval:function(t){return this instanceof w?this:this.has(g)?this instanceof g?new g(this.symbol,this.arg.partialEval(t)):this.recurse("partialEval",t):new x(this.eval(t).toFixed(9)).collect()},sameForm:function(t){return this.tex()===t.tex()},findGCD:function(t){return this.equals(t)?t:m.One},getDenominator:function(){return m.One},asMul:function(){return new h(m.One,this)},isPositive:t,isNegative:function(){return!1},asPositiveFactor:function(){return this.isPositive()?this:m.One},addHint:function(t){if(!t)return this;var e=this.construct(this.args());return e.hints=_.clone(this.hints),e.hints[t]=!0,e},hints:{parens:!1},asExpr:function(){return this},completeParse:function(){return this.recurse("completeParse")},abs:t,negate:function(){return new h(m.Neg,this)}}),n.prototype=new r,_.extend(n.prototype,{args:function(){return this.terms},normalize:function(){var t=_.sortBy(_.invoke(this.terms,"normalize"),function(t){return t.print()});return new this.func(t)},expand:function(){return this.recurse("expand").flatten()},partition:function(){var t=_.groupBy(this.terms,function(t){return t instanceof m}),e=t[!0]||[],t=t[!1]||[];return[new this.func(e),new this.func(t)]},flatten:function(){var e=this,t=_.reject(this.terms,function(t){return t.equals(e.identity)});if(0===t.length)return e.identity;if(1===t.length)return t[0];var n=_.groupBy(t,function(t){return t instanceof e.func}),t=n[!0]||[],t=(n[!1]||[]).concat(_.flatten(_.pluck(t,"terms"),!0));return new e.func(t)},identity:void 0,reduce:t,isPositive:function(){var t=_.invoke(this.terms,"collect");return _.all(_.invoke(t,"isPositive"))},replace:function(t,e){var n=t instanceof r?_.indexOf(this.terms,t):t,t=[];_.isArray(e)?t=e:e&&(t=[e]);n=this.terms.slice(0,n).concat(t).concat(this.terms.slice(n+1));return new this.func(n)},remove:function(t){return this.replace(t)},getDenominator:function(){return new h(_.invoke(this.terms,"getDenominator")).flatten()}}),l.prototype=new n,_.extend(l.prototype,{func:l,eval:function(n,r){return _.reduce(this.terms,function(t,e){return t+e.eval(n,r)},0)},codegen:function(){return _.map(this.terms,function(t){return"("+t.codegen()+")"}).join(" + ")||"0"},print:function(){return _.invoke(this.terms,"print").join("+")},tex:function(){var e="";return _.each(this.terms,function(t){!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()}),e},collect:function(n){var t=_.invoke(this.terms,"collect",n),r=[];_.each(t,function(t){var e;t instanceof h?(e=t.partition(),r.push([e[1].flatten(),e[0].reduce(n)])):t instanceof m?r.push([m.One,t]):r.push([t,m.One])});t=_.groupBy(r,function(t){return t[0].normalize().print()}),t=_.compact(_.map(t,function(t){var e=t[0][0];return new h(new l(_.zip.apply(_,t)[1]).reduce(n),e).collect(n)}));return new l(t).flatten()},factor:function(t){t=_.extend({keepNegative:!1},t);var e=_.invoke(this.terms,"collect"),n=e[0]instanceof h?e[0].terms:[e[0]];_.each(_.rest(this.terms),function(e){n=_.map(n,function(t){return e.findGCD(t)})}),!t.keepNegative&&this.isNegative()&&n.push(m.Neg),n=new h(n).flatten().collect();e=new l(e=_.map(e,function(t){return h.handleDivide(t,n).simplify()})).flatten();return h.createOrAppend(n,e).flatten()},reduce:function(n){return _.reduce(this.terms,function(t,e){return t.add(e,n)},this.identity)},needsExplicitMul:function(){return!1},isNegative:function(){var t=_.invoke(this.terms,"collect");return _.all(_.invoke(t,"isNegative"))},negate:function(){return new l(_.invoke(this.terms,"negate"))}}),h.prototype=new n,_.extend(h.prototype,{func:h,eval:function(n,r){return _.reduce(this.terms,function(t,e){return t*e.eval(n,r)},1)},codegen:function(){return _.map(this.terms,function(t){return"("+t.codegen()+")"}).join(" * ")||"0"},print:function(){return _.map(this.terms,function(t){return t instanceof l?"("+t.print()+")":t.print()}).join("*")},getUnits:function(){var t=_(this.terms).chain().map(function(t){return t.getUnits()}).flatten().value();return t.sort(function(t,e){return t.unit<e.unit}),t},tex:function(){for(var t,e,n=" \\cdot ",r=_.groupBy(this.terms,function(t){return t.isDivide()?"inverse":t instanceof m?"number":"other"}),i=r.inverse||[],u=r.number||[],s=r.other||[],a="",o=0;o<u.length;o++)if(u[o]instanceof v&&!(u[o]instanceof E)&&0<s.length&&0<i.length){var c=u.slice();c.splice(o,1);c=c.concat(i).concat(s);return u[o].tex()+new h(c).tex()}if(t=0===(u=_.compact(_.map(u,function(t){var e=!t.hints.fraction||0<i.length;if(t instanceof v&&!(t instanceof E)&&e){i.push(new p(new E(t.d),m.Div));e=new E(t.n);return e.hints=t.hints,_.any(t.hints)?e:null}return t}))).length&&1===s.length?s[0].tex():(e="",_.each(u,function(t){t.hints.subtract&&t.hints.entered?(a+="-",e+=(e?n:"")+t.abs().tex()):t instanceof E&&-1===t.n&&(t.hints.negate||t.hints.subtract)?a+="-":e+=(e?n:"")+t.tex()}),_.each(s,function(t){t.needsExplicitMul()?e+=(e?n:"")+t.tex():e+=t instanceof l?"("+t.tex()+")":t.tex()}),e||"1"),i.length){r=new h(_.invoke(i,"asDivide")).flatten().tex();return a+"\\frac{"+t+"}{"+r+"}"}return a+t},strip:function(){return new h(_.map(this.terms,function(t){return t instanceof m?t.abs():t.strip()})).flatten()},expand:function(){function e(t){return t instanceof l}function n(t){return t instanceof p&&t.exp.isNegative()}var t=this.recurse("expand").flatten(),r=_.any(t.terms,e),i=_.any(t.terms,function(t){return n(t)&&e(t.base)});if(!r&&!i)return t;var u,s=_.groupBy(t.terms,n),a=s[!1]||[],t=s[!0]||[];return r&&(r=(s=_.groupBy(a,e))[!0]||[],u=s[!1]||[],r=_.reduce(r,function(t,n){return _.reduce(t,function(t,e){return t.concat(_.map(n.terms,function(t){return e.concat(t)}))},[])},[[]]),a=[new l(_.map(r,function(t){return new h(u.concat(t)).flatten()}))]),i&&(t=[new p(new h(_.invoke(t,"getDenominator")).flatten().expand(),m.Div)]),new h(a.concat(t)).flatten()},factor:function(t){var e=this.recurse("factor",t).flatten();if(!(e instanceof h))return e;t=_.groupBy(e.terms,function(t){return t instanceof v}),e=1===(e=_.reduce(t[!0],function(t,e){return{n:t.n*e.n,d:t.d*e.d}},{n:1,d:1})).d?new E(e.n):new v(e.n,e.d);return new h((t[!1]||[]).concat(e)).flatten()},collect:function(r){var t=this.recurse("collect",r).partition(),e=t[0].reduce(r);if(0===e.eval())return m.Zero;if(!((t=t[1].flatten())instanceof h))return new h(e,t).flatten();var t=t.terms,n=[];_.each(t,function(t){t instanceof p?n.push([t.base,t.exp]):n.push([t,m.One])});var i,t=_.groupBy(n,function(t){return t[0].normalize().print()}),t=_.compact(_.map(t,function(t){var e=t[0][0],t=new l(_.zip.apply(_,t)[1]).collect(r);return t instanceof m&&0===t.eval()?null:[e,t]})),u=(n=_.groupBy(t,function(t){return t[0]instanceof o&&t[0].isBasic()?"trig":t[0]instanceof a?"log":"expr"})).trig||[],s=n.log||[],t=n.expr||[];1<u.length&&(i=_.groupBy(u,function(t){return t[0].arg.normalize().print()}),u=[],_.each(i,function(t){var n=t[0][0].arg,e={sin:m.Zero,cos:m.Zero};_.each(t,function(t){e[t[0].type]=t[1]}),h.handleNegative(e.sin).collect(r).equals(e.cos)&&(e=e.cos.isNegative()?{tan:e.sin}:{cot:e.cos}),_.each(e,function(t,e){u.push([new o(e,n),t])})})),1<s.length&&(i=_.groupBy(s,function(t){return t[0].base.normalize().print()}),s=[],_.each(i,function(t){2===t.length&&h.handleNegative(t[0][1]).collect(r).equals(t[1][1])?t[0][1].isNegative()?s.push([new a(t[0][0].power,t[1][0].power),t[1][1]]):s.push([new a(t[1][0].power,t[0][0].power),t[0][1]]):s=s.concat(t)})),n=u.concat(s).concat(t);t=_.map(n,function(t){return new p(t[0],t[1]).collect(r)});return new h([e].concat(t)).flatten()},isSubtract:function(){return _.any(this.terms,function(t){return t instanceof m&&t.hints.subtract})},factorIn:function(t){var e=this.partition()[0].terms;if(e.length&&_.all(e,function(t){return 0<t.n})){var n=e[0].negate();return n.hints=e[0].hints,this.replace(e[0],n.addHint(t))}return new h([m.negativeOne(t)].concat(this.terms))},factorOut:function(){var r=!1,t=_.compact(_.map(this.terms,function(t,e,n){return!r&&t instanceof m&&t.hints.divide?(r=!0,-1!==t.n?t.negate():null):t}));return 1===t.length?t[0]:new h(t)},reduce:function(n){return _.reduce(this.terms,function(t,e){return t.mul(e,n)},this.identity)},findGCD:function(t){return new h(_.invoke(this.terms,"findGCD",t)).flatten()},asMul:function(){return this},asPositiveFactor:function(){return this.isPositive()?this:new h(_.invoke(this.collect().terms,"asPositiveFactor")).flatten()},isNegative:function(){return _.any(_.invoke(this.collect().terms,"isNegative"))},fold:function(){return h.fold(this)},negate:function(){var t=function(t){return t instanceof m};if(_.any(this.terms,t)){t=_.find(this.terms,t);return this.replace(t,t.negate())}return new h([m.Neg].concat(this.terms))}}),_.each([l,h],function(n){_.extend(n,{createOrAppend:function(t,e){return t instanceof n?new n(t.terms.concat(e)):new n(t,e)}})}),_.extend(h,{handleNegative:function(t,e){if(t instanceof m&&0<t.n){var n=t.negate();return n.hints=t.hints,n.addHint(e)}return t instanceof h?t.factorIn(e):new h(m.negativeOne(e),t)},handleDivide:function(t,e){if(e instanceof h){var n=h.handleDivide(t,e.terms[0]),r=new h(_.rest(e.terms)).flatten();return h.handleDivide(n,r)}function i(t){return t instanceof E}if(i(e)&&t instanceof h&&_.any(t.terms,i)){n=t.terms.slice().reverse(),r=_.find(n,function(t){return t instanceof v});if(!i(r))return new h(t.terms.concat([new v(1,e.n).addHint("fraction")]));var u=new v(r.n,e.n);return u.hints=r.hints,r===n[0]&&(u=u.addHint("fraction")),r.n<0&&e.n<0?(u.d=-u.d,t.replace(r,[m.Neg,u])):t.replace(r,u)}u=function(t,e){if(e instanceof E){if(t instanceof E)return t.n<0&&e.n<0?[m.Neg,new v(t.n,-e.n).addHint("fraction")]:[new v(t.n,e.n).addHint("fraction")];var n=new v(1,e.eval());return e.eval()<0?[t,n.addHint("negate")]:[t,n]}return e instanceof o&&e.exp&&(n=e.exp,e.exp=void 0,e=new p(e,n)),e=e instanceof p?new p(e.base,h.handleNegative(e.exp,"divide")):new p(e,m.Div),t instanceof E&&1===t.n?[e]:[t,e]};if(t instanceof h){var s=u(_.last(t.terms),e);return new h(_.initial(t.terms).concat(s))}return new h(s=u(t,e)).flatten()},fold:function(t){if(t instanceof h){var e=_.find(_.initial(t.terms),function(t){return(t instanceof o||t instanceof a)&&t.hints.open}),n=_.indexOf(t.terms,e);if(e){var r=_.last(t.terms);if(!(e.hints.parens||r.hints.parens||r.has(o)||r.has(a))){var i=e instanceof o?o.create([e.type,e.exp],h.createOrAppend(e.arg,r).fold()):a.create(e.base,h.createOrAppend(e.power,r).fold());return 0===n?i:new h(t.terms.slice(0,n).concat(i)).fold()}e.hints.open=!1}function u(t){return-1===t.n&&t.hints.negate}i=t.partition()[0].terms,e=function(t){return 0<t.n};if(1<i.length&&_.some(i,u)&&_.some(i,e)&&_.every(i,function(t){return 0<t.n||u(t)})){i=_.indexOf(t.terms,_.find(t.terms,u)),e=_.indexOf(t.terms,_.find(t.terms,e));if(i<e)return t.replace(e,t.terms[e].negate()).remove(i)}}return t}}),p.prototype=new r,_.extend(p.prototype,{func:p,args:function(){return[this.base,this.exp]},eval:function(t,e){var n=this.base.eval(t,e),r=this.exp.eval(t,e);if(n<0){t=this.exp.simplify();if(t instanceof x&&(i=((e=t.n)-e.toFixed()).toString().length-2,t=new v(e*(i=Math.pow(10,i)),i).simplify()),t instanceof v){var i=Math.abs(t.d)%2==1;if(i)return(Math.abs(t.n)%2==1?-1:1)*Math.pow(-1*n,r)}}return Math.pow(n,r)},getUnits:function(){return this.base.getUnits().map(function(t){return{unit:t.unit,pow:t.pow*this.exp.n}}.bind(this))},codegen:function(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"},print:function(){var t=this.base.print();return(t=this.base instanceof n||this.base instanceof p?"("+t+")":t)+"^("+this.exp.print()+")"},tex:function(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return 1!==this.exp.n&&e("Node marked with hint 'root' does not have exponent of form 1/x."),2===this.exp.d?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof o&&!this.base.isInverse()&&this.exp instanceof m&&this.exp.isSimple()&&0<=this.exp.eval()){var t=this.base.tex({split:!0});return t[0]+"^{"+this.exp.tex()+"}"+t[1]}t=this.base.tex();return this.base instanceof n||this.base instanceof p||this.base instanceof m&&!this.base.isSimple()?t="("+t+")":(this.base instanceof o||this.base instanceof a)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"},needsExplicitMul:function(){return!this.isRoot()&&this.base.needsExplicitMul()},expand:function(){var e=this.recurse("expand");if(e.base instanceof h)return new h(_.map(e.base.terms,function(t){return new p(t,e.exp)})).expand();if(e.base instanceof l&&e.exp instanceof E&&1<e.exp.abs().eval()){function t(t){return n?t:new p(t,m.Div)}for(var n=0<e.exp.eval(),r=e.exp.abs().eval(),i={1:e.base},u=2;u<=r;u*=2){var s=new h(i[u/2],i[u/2]);i[u]=s.expand().collect()}if(_.has(i,r))return t(i[r]);var a=_.map(r.toString(2).split(""),function(t,e,n){return Number(t)*Math.pow(2,n.length-e-1)}),a=_.without(a,0);return t(s=new h(_.pick(i,a)).expand().collect())}return e.exp instanceof l?new h(_.map(e.exp.terms,function(t){return new p(e.base,t).expand()})).expand():e},factor:function(){var e=this.recurse("factor");return e.base instanceof h?new h(_.map(e.base.terms,function(t){return t instanceof E&&e.exp.equals(m.Div)?new v(1,t.n):new p(t,e.exp)})):e},collect:function(t){if(this.base instanceof p)return new p(this.base.base,i=h.createOrAppend(this.base.exp,this.exp)).collect(t);function e(t){return t instanceof a&&t.base.equals(n.base)}var n=this.recurse("collect",t);if(n.exp instanceof m&&0===n.exp.eval())return m.One;if(n.exp instanceof m&&1===n.exp.eval())return n.base;if(e(n.exp))return n.exp.power;if(n.exp instanceof h&&_.any(n.exp.terms,e)){var r=_.find(n.exp.terms,e);return new p(r.power,i=n.exp.remove(r).flatten()).collect(t)}if(n.base instanceof m&&n.exp instanceof m){if(t&&t.preciseFloats){var i=n.exp.asRational();if(n.base.getDecimalPlaces()<new p(n.base,new v(1,i.d)).collect().getDecimalPlaces()){r=new p(n.base,new E(i.n)).collect();return new p(r,new v(1,i.d))}}return n.base.raiseToThe(n.exp,t)}return n},isDivide:function(){function t(t){return t instanceof m&&t.hints.divide}return t(this.exp)||this.exp instanceof h&&_.any(this.exp.terms,t)},asDivide:function(){if(this.exp instanceof m){if(-1===this.exp.eval())return this.base;var t=this.exp.negate();return t.hints=_.clone(this.exp.hints),t.hints.divide=!1,new p(this.base,t)}if(this.exp instanceof h)return new p(this.base,this.exp.factorOut());e("called asDivide() on an Expr that wasn't a Num or Mul")},isRoot:function(){return this.exp instanceof v&&this.exp.hints.root},isSquaredTrig:function(){return this.base instanceof o&&!this.base.isInverse()&&this.exp instanceof m&&2===this.exp.eval()},getDenominator:function(){if(this.exp instanceof m&&-1===this.exp.eval())return h.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var t=new p(this.base,h.handleNegative(this.exp).collect());return h.createOrAppend(t,t.collect().getDenominator()).flatten()}return this.base instanceof m?new p(this.base.getDenominator(),this.exp).collect():m.One},findGCD:function(t){var e,n=t instanceof p?(e=t.base,t.exp):(e=t,m.One);if(this.base.equals(e)){if(this.exp.equals(n))return this;if(this.exp instanceof m&&n instanceof m)return new p(this.base,m.min(this.exp,n)).collect();if(this.exp instanceof m||n instanceof m)return m.One;t=this.exp.asMul().partition(),n=n.asMul().partition();if(t[1].equals(n[1]))return new p(e,new h(m.min(t[0].reduce(),n[0].reduce()),t[1].flatten()).flatten()).collect()}return m.One},isPositive:function(){if(this.base.isPositive())return!0;var t=this.exp.simplify();return t instanceof E&&t.eval()%2==0},asPositiveFactor:function(){if(this.isPositive())return this;var t=this.exp.simplify();if(t instanceof E){t=t.eval();if(2<t)return new p(this.base,new E(t-1));if(t<-2)return new p(this.base,new E(t+1))}return m.One}}),_.extend(p,{sqrt:function(t){return new p(t,m.Sqrt)},nthroot:function(t,e){return new p(t,h.fold(h.handleDivide(new E(1),e)).addHint("root"))}}),a.prototype=new r,_.extend(a.prototype,{func:a,args:function(){return[this.base,this.power]},eval:function(t,e){return Math.log(this.power.eval(t,e))/Math.log(this.base.eval(t,e))},codegen:function(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"},print:function(){var t="("+this.power.print()+")";return this.isNatural()?"ln"+t:"log_("+this.base.print()+") "+t},tex:function(){var t="("+this.power.tex()+")";return this.isNatural()?"\\ln"+t:"\\log_{"+this.base.tex()+"}"+t},collect:function(t){t=this.recurse("collect",t);return t.power instanceof m&&1===t.power.eval()?m.Zero:t.base.equals(t.power)?m.One:t.power instanceof p&&t.power.base.equals(t.base)?t.power.exp:t},expand:function(){var e=this.recurse("expand");return e.power instanceof h?new l(_.map(e.power.terms,function(t){return new a(e.base,t).expand()})):e.power instanceof p?new h(e.power.exp,new a(e.base,e.power.base).expand()).flatten():e.isNatural()?e:h.handleDivide(new a(d.e,e.power),new a(d.e,e.base))},hints:_.extend(a.prototype.hints,{open:!1}),isPositive:function(){var t=this.collect();return t.base instanceof m&&t.power instanceof m&&0<this.eval()},needsExplicitMul:function(){return!1},isNatural:function(){return this.base.equals(d.e)}}),_.extend(a,{natural:function(){return d.e},common:function(){return m.Ten},create:function(t,e){t=new a(t,e);return t=!e.hints.parens?t.addHint("open"):t}}),o.prototype=new r,_.extend(o.prototype,{func:o,args:function(){return[this.type,this.arg]},functions:{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return h.handleDivide(o.sin(this.arg),o.cos(this.arg))}},csc:{eval:function(t){return 1/Math.sin(t)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return h.handleDivide(m.One,o.sin(this.arg))}},sec:{eval:function(t){return 1/Math.cos(t)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return h.handleDivide(m.One,o.cos(this.arg))}},cot:{eval:function(t){return 1/Math.tan(t)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return h.handleDivide(o.cos(this.arg),o.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(t){return Math.asin(1/t)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(t){return Math.acos(1/t)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(t){return Math.atan(1/t)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(t){return(Math.exp(t)-Math.exp(-t))/2},codegen:function(t){return"((Math.exp("+t+") - Math.exp(-("+t+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(t){return(Math.exp(t)+Math.exp(-t))/2},codegen:function(t){return"((Math.exp("+t+") + Math.exp(-("+t+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))},codegen:function(t){return"((Math.exp("+t+") - Math.exp(-("+t+"))) / (Math.exp("+t+") + Math.exp(-("+t+"))))"},tex:"\\tanh",expand:function(){return h.handleDivide(o.sinh(this.arg),o.cosh(this.arg))}},csch:{eval:function(t){return 2/(Math.exp(t)-Math.exp(-t))},codegen:function(t){return"(2 / (Math.exp("+t+") - Math.exp(-("+t+"))))"},tex:"\\csch",expand:function(){return h.handleDivide(m.One,o.sinh(this.arg))}},sech:{eval:function(t){return 2/(Math.exp(t)+Math.exp(-t))},codegen:function(t){return"(2 / (Math.exp("+t+") + Math.exp(-("+t+"))))"},tex:"\\sech",expand:function(){return h.handleDivide(m.One,o.cosh(this.arg))}},coth:{eval:function(t){return(Math.exp(t)+Math.exp(-t))/(Math.exp(t)-Math.exp(-t))},codegen:function(t){return"((Math.exp("+t+") + Math.exp(-("+t+"))) / (Math.exp("+t+") - Math.exp(-("+t+"))))"},tex:"\\coth",expand:function(){return h.handleDivide(o.cosh(this.arg),o.sinh(this.arg))}}},isEven:function(){return _.contains(["cos","sec"],this.type)},isInverse:function(){return 0===this.type.indexOf("arc")},isBasic:function(){return _.contains(["sin","cos"],this.type)},eval:function(t,e){return(0,this.functions[this.type].eval)(this.arg.eval(t,e))},codegen:function(){var t=this.functions[this.type].codegen;if("function"==typeof t)return t(this.arg.codegen());if("string"==typeof t)return t+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)},print:function(){return this.type+"("+this.arg.print()+")"},tex:function(t){var e=this.functions[this.type].tex,n="("+this.arg.tex()+")";return t&&t.split?[e,n]:e+n},hints:_.extend(o.prototype.hints,{open:!1}),isPositive:function(){return this.collect().arg instanceof m&&0<this.eval()},completeParse:function(){if(this.exp){var t=new p(this,this.exp);return this.exp=void 0,t}return this},needsExplicitMul:function(){return!1},expand:function(){var t=this.recurse("expand");if(t.isInverse())return t;var e=t.functions[t.type].expand;return _.bind(e,t)()},collect:function(t){var e=this.recurse("collect",t);if(e.isInverse()||!e.arg.isNegative())return e;t=e.arg instanceof m?e.arg.abs():h.handleDivide(e.arg,m.Neg).collect(t);return e.isEven()?new o(e.type,t):new h(m.Neg,new o(e.type,t))}}),_.extend(o,{create:function(t,e){var n=t[0],t=t[1];t&&t.equals(m.Neg)&&(n="arc"+n,t=void 0);n=new o(n,e);return e.hints.parens||(n=n.addHint("open")),t&&(n.exp=t),n},sin:function(t){return new o("sin",t)},cos:function(t){return new o("cos",t)},sinh:function(t){return new o("sinh",t)},cosh:function(t){return new o("cosh",t)}}),i.prototype=new r,_.extend(i.prototype,{func:i,args:function(){return[this.arg]},eval:function(t,e){return Math.abs(this.arg.eval(t,e))},codegen:function(){return"Math.abs("+this.arg.codegen()+")"},print:function(){return"abs("+this.arg.print()+")"},tex:function(){return"\\left|"+this.arg.tex()+"\\right|"},collect:function(t){var e=this.recurse("collect",t);if(e.arg.isPositive())return e.arg;if(e.arg instanceof m)return e.arg.abs();if(e.arg instanceof h){var n=_.groupBy(e.arg.terms,function(t){return t.isPositive()?"positive":t instanceof m?"number":"other"}),t=n.positive.concat(_.invoke(n.number,"abs"));return n.other.length&&t.push(new i(new h(n.other).flatten())),new h(t).flatten()}return e},expand:function(){var t=this.recurse("expand");return t.arg instanceof h?new h(_.map(t.arg.terms,function(t){return new i(t)})):t},isPositive:function(){return!0}}),y.prototype=new r,_.extend(y.prototype,{func:y,args:function(){return[this.left,this.type,this.right]},needsExplicitMul:function(){return!1},print:function(){return this.left.print()+this.type+this.right.print()},signs:{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},tex:function(){return this.left.tex()+this.signs[this.type]+this.right.tex()},normalize:function(){var t=this.recurse("normalize");return _.contains([">",">="],t.type)?new y(t.right,t.type.replace(">","<"),t.left):t},asExpr:function(t){var e=function(t){return t instanceof m&&t.isSimple()&&0===t.eval()},n=[];this.left instanceof l?n=_.clone(this.left.terms):e(this.left)||(n=[this.left]),this.right instanceof l?n=n.concat(this.right.negate().terms):e(this.right)||n.push(this.right.negate());for(var r=!this.isEquality(),n=_.invoke(n,"collect",{preciseFloats:!0}),i=0;i<n.length;i++){var u=n[i].getDenominator();(u=r&&!u.isPositive()?u.asPositiveFactor():u).equals(m.One)||(n=_.map(n,function(t){return h.createOrAppend(t,u).simplify({once:!0,preciseFloats:!0})}))}e=new l(n).flatten();return t?e:this.divideThrough(e)},divideThrough:function(t){var e=!this.isEquality(),n=t.simplify({once:!0}),r=n.factor({keepNegative:e});if(!(r instanceof h))return t;var i=r.terms,u=_.groupBy(i,function(t){return t instanceof l}),t=u[!0]||[],u=u[!1]||[];if(t.length&&this.isEquality())return new h(t).flatten();t.length||(u=_.reject(u,function(t){return!!t.getVars().length})),e&&(u=_.invoke(u,"asPositiveFactor")),u=_.reject(u,function(t){return t.equals(m.One)});u=_.map(u,function(t){return new p(t,m.Div)}),u=new h(i.concat(u)).collect();return u.equals(r)?n:u},isEquality:function(){return _.contains(["=","<>"],this.type)},compare:function(t){if(!(t instanceof y))return!1;var e=this.normalize(),n=t.normalize();if(e.type!==n.type)return!1;t=e.divideThrough(e.asExpr(!0).collect()),n=n.divideThrough(n.asExpr(!0).collect());return e.isEquality()?t.compare(n)||t.compare(h.handleNegative(n)):t.compare(n)},sameForm:function(t){var e=this.normalize(),n=t.normalize(),t=e.left.sameForm(n.left)&&e.right.sameForm(n.right);return e.isEquality()?t||e.left.sameForm(n.right)&&e.right.sameForm(n.left):t},isSimplified:function(){var t=this.asExpr(!0),e=this.divideThrough(t).simplify();return t.equals(e)&&this.left.isSimplified()&&this.right.isSimplified()}}),_.extend(y.prototype,{solveLinearEquationForVariable:function(t){var e=this.asExpr();if(!e.is(l)||2!==e.terms.length)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var n,r,i=(r=e.terms[0]).has(c)&&_.contains(r.getVars(),t.symbol)?(n=h.handleNegative(e.terms[1]),h.handleDivide(e.terms[0],t)):(n=h.handleNegative(e.terms[0]),h.handleDivide(e.terms[1],t));return h.handleDivide(n,i).simplify()}}),s.prototype=new r,_.extend(s.prototype,{needsExplicitMul:function(){return!1},findGCD:function(t){return t instanceof s||t instanceof m?this.equals(t)?this:m.One:t.findGCD(this)}}),g.prototype=new s,_.extend(g.prototype,{func:g,args:function(){return[this.symbol,this.arg]},print:function(){return this.symbol+"("+this.arg.print()+")"},tex:function(){return this.symbol+"("+this.arg.tex()+")"},eval:function(t,e){var n=this.arg,r=t[this.symbol],t=_.extend(_.clone(t),{x:n.eval(t,e)}),r=u.parse(r,e);return r.parsed?r.expr.eval(t,e):r},codegen:function(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"},getUnits:function(){return this.arg.getUnits()},getVars:function(t){return t?this.arg.getVars():_.union(this.arg.getVars(),[this.symbol]).sort()},getConsts:function(){return this.arg.getConsts()}}),c.prototype=new s,_.extend(c.prototype,{func:c,args:function(){return[this.symbol,this.subscript]},exprArgs:function(){return[]},recurse:function(){return this},print:function(){var t="";return this.subscript&&(t="_("+this.subscript.print()+")"),this.symbol+t},prettyPrint:function(){var t=this.subscript;return t&&(t instanceof m||t instanceof s)?this.symbol+"_"+t.print():this.print()},tex:function(){var t="";return this.subscript&&(t="_{"+this.subscript.tex()+"}"),(1<this.symbol.length?"\\":"")+this.symbol+t},repr:function(){return"Var("+this.print()+")"},eval:function(t,e){return t[this.prettyPrint()]},codegen:function(){return'vars["'+this.prettyPrint()+'"]'},getVars:function(){return[this.prettyPrint()]},isPositive:function(){return!1}}),d.prototype=new s,_.extend(d.prototype,{func:d,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(t,e){return"pi"===this.symbol?Math.PI:"e"===this.symbol?Math.E:void 0},codegen:function(){return"pi"===this.symbol?"Math.PI":"e"===this.symbol?"Math.E":void 0},print:function(){return this.symbol},tex:function(){return"pi"===this.symbol?"\\pi ":"e"===this.symbol?"e":void 0},isPositive:function(){return 0<this.eval()},abs:function(){return 0<this.eval()?this:h.handleNegative(this)},getConsts:function(){return[this.print()]}}),d.e=new d("e"),d.pi=new d("pi"),m.prototype=new r,_.extend(m.prototype,{repr:function(){return this.print()},strip:function(){return this.abs()},recurse:function(){return this},codegen:function(){return this.print()},add:t,mul:t,negate:t,isSubtract:function(){return this.hints.subtract},abs:t,needsExplicitMul:function(){return!0},findGCD:t,isPositive:function(){return 0<this.eval()},isNegative:function(){return this.eval()<0},asPositiveFactor:function(){return this.isPositive()?this:this.abs()},hints:_.extend(m.prototype.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}),isSimple:t,getDecimalPlaces:function(){var t=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},asRational:t}),v.prototype=new m,_.extend(v.prototype,{func:v,args:function(){return[this.n,this.d]},eval:function(){return this.n/this.d},print:function(){return this.n.toString()+"/"+this.d.toString()},tex:function(){var t="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+t:t},add:function(t,e){return t instanceof v?new v(this.n*t.d+this.d*t.n,this.d*t.d).collect():t.add(this,e)},mul:function(t,e){return t instanceof v?new v(this.n*t.n,this.d*t.d).collect():t.mul(this,e)},collect:function(){var t=m.findGCD(this.n,this.d),e=this.n/t,t=this.d/t;return 1==t?new E(e):new v(e,t)},negate:function(){return new v(-this.n,this.d)},abs:function(){return new v(Math.abs(this.n),this.d)},findGCD:function(t){return t instanceof v?new v(m.findGCD(this.n*t.d,t.n*this.d),this.d*t.d).collect():t instanceof E?new v(m.findGCD(this.n,t.n),this.d):t.findGCD(this)},raiseToThe:function(t){if(t instanceof E){var e=0<t.eval(),n=t.abs().eval(),r=Math.pow(this.n,n),n=Math.pow(this.d,n);return(e?new v(r,n):new v(n,r)).collect()}return new x(this.eval()).raiseToThe(t)},getDenominator:function(){return new E(this.d)},isSimple:function(){return!1},asRational:function(){return this}}),E.prototype=new v(0,1),_.extend(E.prototype,{func:E,args:function(){return[this.n]},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},negate:function(){return new E(-this.n)},abs:function(){return new E(Math.abs(this.n))},isSimple:function(){return!0},findGCD:function(t){return t instanceof E?new E(m.findGCD(this.n,t.n)):t.findGCD(this)}}),_.extend(E,{create:function(t){return new E(t).addHint("entered")}}),x.prototype=new m,_.extend(x.prototype,{func:x,args:function(){return[this.n]},eval:function(){return this.n},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},add:function(t,e){return e&&e.preciseFloats?x.toDecimalPlaces(this.n+t.eval(),Math.max(this.getDecimalPlaces(),t.getDecimalPlaces())):new x(this.n+t.eval()).collect()},mul:function(t,e){return e&&e.preciseFloats?x.toDecimalPlaces(this.n*t.eval(),this.getDecimalPlaces()+t.getDecimalPlaces()):new x(this.n*t.eval()).collect()},collect:function(){return this},negate:function(){return new x(-this.n)},abs:function(){return new x(Math.abs(this.n))},findGCD:function(t){return t instanceof m?new x(m.findGCD(this.eval(),t.eval())).collect():t.findGCD(this)},raiseToThe:function(t,e){return e&&e.preciseFloats&&t instanceof E&&1<t.n?x.toDecimalPlaces(new p(this,t).eval(),this.getDecimalPlaces()*t.n):new x(new p(this,t).eval()).collect()},asRational:function(){var t=this.n.toString().split(".");return 1===t.length?new v(this.n,1):new v(Number(t.join("")),Math.pow(10,t[1].length)).collect()},getDenominator:function(){return this.asRational().getDenominator()},isSimple:function(){return!0}}),_.extend(x,{create:function(t){return new x(t).addHint("entered")},toDecimalPlaces:function(t,e){return new x(+t.toFixed(Math.min(e,20))).collect()}}),_.extend(m,{negativeOne:function(t){return"subtract"===t?m.Sub:"divide"===t?m.Div:m.Neg},findGCD:function(t,e){var n;if(t=Math.abs(t),e=Math.abs(e),t!==Math.floor(t)||e!==Math.floor(e))return 1;for(;e;)n=t%e,t=e,e=n;return t},min:function(){return _.min(_.toArray(arguments),function(t){return t.eval()})},max:function(){return _.max(_.toArray(arguments),function(t){return t.eval()})}}),m.Neg=new E(-1).addHint("negate"),m.Sub=new E(-1).addHint("subtract"),m.Div=new E(-1).addHint("divide"),m.Sqrt=new v(1,2).addHint("root"),m.Zero=new E(0),m.One=new E(1),m.Ten=new E(10),l.prototype.identity=m.Zero,h.prototype.identity=m.One;var b=u.parser;function w(t){this.symbol=t}b.yy={Add:l,Mul:h,Pow:p,Log:a,Trig:o,Eq:y,Abs:i,Func:g,Const:d,Var:c,Int:E,Float:x,parseError:function(t,e){throw new Error(e.loc.first_column)},constants:["e"],symbolLexer:function(t){return _.contains(b.yy.constants,t)?"CONST":_.contains(b.yy.functions,t)?"FUNC":"VAR"}},u.parse=function(t,e){try{return e&&e.functions?b.yy.functions=_.without(e.functions,"i"):b.yy.functions=[],e&&e.decimal_separator&&(t=t.split(e.decimal_separator).join(".")),{parsed:!0,expr:b.parse(t).completeParse()}}catch(t){return{parsed:!1,error:t.message}}},w.prototype=new s;function A(e){if(_(F).has(e)||_(S).has(e))return new w(e);var t=_(_(D).keys()).find(function(t){return new RegExp("^"+t).test(e)});if(t){var n=e.replace(new RegExp("^"+t),"");if(_(F).has(n)||S[n]&&S[n].prefixes===k)return new h(D[t],new w(n));throw new Error(n+" does not allow prefixes")}return new w(e)}u.unitParse=function(t){try{var e=u.unitParser.parse(t),n=[];_(e.unit.num).each(function(t){n.push(new p(A(t.name),new E(t.pow)))}),_(e.unit.denom).each(function(t){n.push(new p(A(t.name),new E(-1*t.pow)))});var r=new h(n).flatten();return"unitMagnitude"!==e.type?{parsed:!0,unit:r,type:e.type}:{parsed:!0,unit:r,expr:new h([new x(+e.magnitude)].concat(n)),coefficient:e.magnitude,type:e.type}}catch(t){return{parsed:!1,error:t.message}}},_.extend(w.prototype,{func:w,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(t,e){return 1},getUnits:function(){return[{unit:this.symbol,pow:1}]},codegen:function(){return"1"},print:function(){return this.symbol},tex:function(){return this.symbol},collect:function(t){if(_(F).has(this.symbol))return this;if(_(S).has(this.symbol))return S[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}});var F={m:new w("m"),g:new w("g"),s:new w("s"),A:new w("A"),K:new w("K"),mol:new w("mol"),cd:new w("cd")},D={a:new p(new E(10),new E(-18)),f:new p(new E(10),new E(-15)),p:new p(new E(10),new E(-12)),n:new p(new E(10),new E(-9)),u:new p(new E(10),new E(-6)),m:new p(new E(10),new E(-3)),c:new p(new E(10),new E(-2)),d:new p(new E(10),new E(-1)),da:new E(10),h:new p(new E(10),new E(2)),k:new p(new E(10),new E(3)),M:new p(new E(10),new E(6)),G:new p(new E(10),new E(9)),T:new p(new E(10),new E(12)),P:new p(new E(10),new E(15)),E:new p(new E(10),new E(18)),hella:new p(new E(10),new E(27))},k={},C={},t=function(t,e){var n=t.split("|"),r=n[0].trim(),t=n[1].trim(),n=m.One;""!==r&&(n=u.parse(r).expr);var t=t.split("/"),i=[n];return t[0]&&t[0].split(" ").filter(function(t){return""!==t}).map(function(t){i.push(new w(t))}),t[1]&&t[1].split(" ").filter(function(t){return""!==t}).map(function(t){i.push(new p(new w(t),m.Div))}),{conversion:new h(i),prefixes:e}},S={Da:t("1.6605388628 x 10^-24 | g",k),u:t("| Da",C),meter:t("| m",C),meters:t("| m",C),in:t("254 / 10000 | m",C),ft:t("3048  / 10000 | m",C),yd:t("9144  / 10000 | m",C),mi:t("1609344 / 1000 | m",C),ly:t("9.4607 x 10^15 | m",C),nmi:t("1852 | m",C),"Å":t("10^-10 | m",C),pc:t("3.0857 x 10^16 | m",C),min:t("60 | s",C),hr:t("3600 | s",C),sec:t("| s",C),day:t("86400 | s",C),wk:t("604800 | s",C),fortnight:t("14 | day",C),shake:t("10^-8 | s",C),olympiad:t("126200000 | s",C),"°C":t("1 | K",C),"°F":t("5/9 | K",C),"°R":t("5/9 | K",C),e:t("1.6021765314 x 10^-19 | C",C),c:t("299792458 | m / s",C),kn:t("514/1000 | m / s",C),kt:t("| kn",C),knot:t("| kn",C),J:t("| N m",k),BTU:t("1060 | J",C),cal:t("4184 / 1000 | J",k),eV:t("1.602176514 x 10^-19 | J",k),erg:t("10^−7 | J",k),W:t("| J / s",k),"H-e":t("80 | W",C),N:t("1000 | g m / s s",k),lb:t("4448221615 / 1000000000 | N",C),dyn:t("10^-5 | N",C),Pa:t("1 | N / m m m",k),bar:t("10^5 | Pa",k),"㏔":t("1/1000 | bar",C),"㍴":t("| bar",C),atm:t("101325 | Pa",C),Torr:t("1/760 | atm",C),mmHg:t("| Torr",C),ha:t("10^4 | m m",C),b:t("10^−28 | m m",k),barn:t("| b",k),acre:t("4046.87 | m m",C),skilodge:t("10^-31 | m m",C),outhouse:t("10^-34 | m m",C),shed:t("10^-52 | m m",C),L:t("1/1000 | m m m",k),gal:t("3785/1000 | L",k),cup:t("1/16 | gal",C),qt:t("1/4 | gal",C),quart:t("| qt",C),p:t("1/8 | gal",C),pt:t("| p",C),pint:t("| p",C),"fl oz":t("1/8 | cup",C),"fl. oz.":t("1/8 | cup",C),tbsp:t("1/16 | cup",C),tsp:t("1/3 | tbsp",C),rev:t("2 pi | rad",C),deg:t("180 pi | rad",C),"°":t("| deg",C),arcminute:t("1/60 | deg",C),arcsec:t("1/3600 | deg",C),Hu:t("1000 | dB",k),dozen:t("12 |",C),mol:t("6.0221412927 x 10^23 |",k),"%":t("1/100 |",C),percent:t("| %",C),ppm:t("1/1000000 |",C),V:t("1000 | g m m / s s C",k),C:t("| A s",k),ampere:t("| A",C),"Ω":t("| V / A",k),ohm:t("| Ω",C),F:t("| C / V",k),H:t("| ohm s",k),T:t("1000 | g / C s",k),Wb:t("1000 | g m m / C s",k),lm:t("pi x 10^4 | cd / m m",C),lx:t("| lm / m m",C),nit:t("| cd / m m",C),sb:t("10^4 | cd / m m",C),stilb:t("1 | sb",C),apostilb:t("1 / pi x 10^(-4) | sb",C),blondel:t("| apostilb",C),asb:t("| apostilb",C),la:t("| lm",C),Lb:t("| lm",C),sk:t("10^-7 | lm",C),skot:t("| sk",C),bril:t("10^-11 | lm",C),Hz:t("| / s",k)};u.Add=l,u.Mul=h,u.Pow=p,u.Log=a,u.Eq=y,u.Trig=o,u.Abs=i,u.Func=g,u.Var=c,u.Const=d,u.Unit=w,u.Rational=v,u.Int=E,u.Float=x,u.Zero=m.Zero,u.One=m.One}(KAS),KAS.compare=function(t,e,n){var r={form:!1,simplify:!1};n=void 0!==n?_.extend(r,n):r;r=t.sameVars(e);if(r.equal)return t.compare(e)?n.form&&!t.sameForm(e)?{equal:!1,message:"Your answer is not in the correct form."}:n.simplify&&!t.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null};t=r.equalIgnoringCase?"Check your variables; one or more are using the wrong case (upper or lower).":"Check your variables; you may have used the wrong letter for one or more of them.";return{equal:!1,wrongVariableCase:r.equalIgnoringCase,wrongVariableNames:!r.equalIgnoringCase,message:t}},function(r,e){"use strict";if(Object.prototype.hasOwnProperty.call(r,"ActiveXObject")&&(r.ActiveXObject=e),r.Blob=e,r.clearInterval=e,r.clearTimeout=e,r.eval=e,r.fetch&&(r.fetch=e),r.Function=e,r.importScripts=e,r.indexedDB)try{r.indexedDB=e}catch(t){r.indexedDB.open=e,r.indexedDB.deleteDatabase=e,r.indexedDB.cmp=e,r.indexedDB.webkitGetDatabaseNames=e}if(r.mozIndexedDB)try{r.mozIndexedDB=e}catch(t){r.mozIndexedDB.open=e,r.mozIndexedDB.deleteDatabase=e,r.mozIndexedDB.cmp=e}if(r.msIndexedDB)try{r.msIndexedDB=e}catch(t){r.msIndexedDB.open=e,r.msIndexedDB.deleteDatabase=e,r.msIndexedDB.cmp=e}if(r.requestFileSystem&&(r.requestFileSystem=e),r.requestFileSystemSync&&(r.requestFileSystemSync=e),r.resolveLocalFileSystemURL&&(r.resolveLocalFileSystemURL=e),r.resolveLocalFileSystemSyncURL&&(r.resolveLocalFileSystemSyncURL=e),r.setInterval=e,r.setTimeout=e,r.XMLHttpRequest=e,r.webkitIndexedDB)try{r.webkitIndexedDB=e}catch(t){r.webkitIndexedDB.open=e,r.webkitIndexedDB.deleteDatabase=e,r.webkitIndexedDB.cmp=e,r.webkitIndexedDB.webkitGetDatabaseNames=e}r.webkitRequestFileSystem&&(r.webkitRequestFileSystem=e),r.webkitRequestFileSystemSync&&(r.webkitRequestFileSystemSync=e),r.webkitResolveLocalFileSystemURL&&(r.webkitResolveLocalFileSystemURL=e),r.webkitResolveLocalFileSystemSyncURL&&(r.webkitResolveLocalFileSystemSyncURL=e),r.Worker&&(r.Worker=e),r.soundex=function(t){if(!(t=(t+"").toUpperCase()))return"";for(var e,n,r=[0,0,0,0],i={B:1,F:1,P:1,V:1,C:2,G:2,J:2,K:2,Q:2,S:2,X:2,Z:2,D:3,T:3,L:4,M:5,N:5,R:6},u=0,s=0;(e=t.charAt(u++))&&s<4;)(e=i[e])?e!==n&&(r[s++]=n=e):(s+=1===u,n=0);return r[0]=t.charAt(0),r.join("")},r.metaphone=function(t,e){var n=typeof t;if("undefined"==n||"object"==n&&null!==t)return null;if("number"==n&&(isNaN(t)?t="NAN":isFinite(t)||(t="INF")),e<0)return!1;e=Math.floor(+e)||0;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="AEIOU",n=new RegExp("^[^"+r+"]+");if(!(t=(t="string"==typeof t?t:"").toUpperCase().replace(n,"")))return"";function u(t,e){return""!==e&&-1!==t.indexOf(e)}var s,a,o=0,c=t.charAt(0),l=t.charAt(1),h=t.length,f="";switch(c){case"A":f+="E"===l?l:c,o+=1;break;case"G":case"K":case"P":"N"===l&&(f+=l,o+=2);break;case"W":"R"===l?(f+=l,o+=2):"H"!==l&&!u(i,l)||(f+="W",o+=2);break;case"X":f+="S",o+=1;break;case"E":case"I":case"O":case"U":f+=c,o++}for(;o<h&&(0===e||f.length<e);o+=1)if(c=t.charAt(o),l=t.charAt(o+1),a=t.charAt(o-1),s=t.charAt(o+2),c!==a||"C"===c)switch(c){case"B":"M"!==a&&(f+=c);break;case"C":u("EIY",l)?"I"===l&&"A"===s?f+="X":"S"!==a&&(f+="S"):"H"===l?(f+="X",o+=1):f+="K";break;case"D":"G"===l&&u("EIY",s)?(f+="J",o+=1):f+="T";break;case"G":"H"===l?u("BDH",t.charAt(o-3))||"H"===t.charAt(o-4)||(f+="F",o+=1):"N"===l?u(r,s)&&"NED"!==t.substr(o+1,3)&&(f+="K"):u("EIY",l)&&"G"!==a?f+="J":f+="K";break;case"H":u(i,l)&&!u("CGPST",a)&&(f+=c);break;case"K":"C"!==a&&(f+="K");break;case"P":f+="H"===l?"F":c;break;case"Q":f+="K";break;case"S":"I"===l&&u("AO",s)?f+="X":"H"===l?(f+="X",o+=1):f+="S";break;case"T":"I"===l&&u("AO",s)?f+="X":"H"===l?(f+="0",o+=1):"CH"!==t.substr(o+1,2)&&(f+="T");break;case"V":f+="F";break;case"W":case"Y":u(i,l)&&(f+=c);break;case"X":f+="KS";break;case"Z":f+="S";break;case"F":case"J":case"L":case"M":case"N":case"R":f+=c}return f},r.removeDiacritics=function(t){var e,n={A:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,AA:/[\uA732]/g,AE:/[\u00C6\u01FC\u01E2]/g,AO:/[\uA734]/g,AU:/[\uA736]/g,AV:/[\uA738\uA73A]/g,AY:/[\uA73C]/g,B:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g,C:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g,D:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g,DZ:/[\u01F1\u01C4]/g,Dz:/[\u01F2\u01C5]/g,E:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,F:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g,G:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g,H:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g,I:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,J:/[\u004A\u24BF\uFF2A\u0134\u0248]/g,K:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g,L:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g,LJ:/[\u01C7]/g,Lj:/[\u01C8]/g,M:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g,N:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g,NJ:/[\u01CA]/g,Nj:/[\u01CB]/g,O:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,OI:/[\u01A2]/g,OO:/[\uA74E]/g,OU:/[\u0222]/g,P:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g,Q:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g,R:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g,S:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g,T:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g,TZ:/[\uA728]/g,U:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,V:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g,VY:/[\uA760]/g,W:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g,X:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g,Y:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g,Z:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g,a:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,aa:/[\uA733]/g,ae:/[\u00E6\u01FD\u01E3]/g,ao:/[\uA735]/g,au:/[\uA737]/g,av:/[\uA739\uA73B]/g,ay:/[\uA73D]/g,b:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g,c:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,d:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g,dz:/[\u01F3\u01C6]/g,e:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,f:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g,g:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g,h:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g,hv:/[\u0195]/g,i:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,j:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g,k:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g,l:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g,lj:/[\u01C9]/g,m:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g,n:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,nj:/[\u01CC]/g,o:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,oi:/[\u01A3]/g,ou:/[\u0223]/g,oo:/[\uA74F]/g,p:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g,q:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g,r:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g,s:/[\u0073\u24E2\uFF53\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g,ss:/[\u00DF]/g,t:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g,tz:/[\uA729]/g,u:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,v:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g,vy:/[\uA761]/g,w:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g,x:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g,y:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g,z:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g};for(e in n)t=t.replace(n[e],e);return t},Array.prototype.equals=function(t){if(!t)return!1;if(this.length!==t.length)return!1;for(var e=0,n=this.length;e<n;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].equals(t[e]))return!1}else if(this[e]!==t[e])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1}),r.Formula=function(e){if(!(this instanceof r.Formula))return new r.Formula(e);try{this._expression=e,this._ast=r.KAS.parse(e).expr}catch(t){e=new Error("Error parsing `"+e+"`");throw e.originalError=t,e}},r.Formula.prototype.equals=function(e){var t,n=!1;try{t=r.KAS.parse(e).expr}catch(t){e=new Error("Error parsing `"+e+"`");throw e.originalError=t,e}try{n=r.KAS.compare(this._ast,t).equal}catch(t){}return n}}(this);